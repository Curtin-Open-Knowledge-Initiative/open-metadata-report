<style>

    @page {
        size: a4 portrait;
        @frame null {
        left: 1cm;
        width: 18cm;
        top: 7cm;
        height: 20cm;
    }}

    @page titlepage {
        size: a4 portrait;
        background-image: url("/Users/266883j/PycharmProjects/es_reports/assets/title_image.png");
        @frame title {
        left: 2cm;
        width: 16cm;
        top: 8.9cm;
        height: 19cm;
    }}

    @page report {
        size: a4 portrait;
        @frame content_frame {
        left: 2cm;
        width: 17cm;
        top: 2.5cm;
        height: 24.2cm;
    }}

     @page landscape-report {
        size: a4 landscape;
        @frame content_frame {
        left: 2cm;
        width: 24.7cm;
        top: 2cm;
        height: 17.5cm;
    }}

        @page lastpage {
        size: a4 portrait;
        background-image: url("/Users/266883j/PycharmProjects/es_reports/assets/final_page.png");
        @frame content_frame {
        left: 2cm;
        width: 17cm;
        top: 2.5cm;
        height: 24.2cm;
    }}

    body {
        font-family: brandon-grotesque, sans-serif;
        font-size: 10pt;
        font-weight: 300;
        font-style: normal;
        line-height: 140%;
    }

    .titleface {
        text-transform: uppercase;
        font-family: brandon-grotesque, sans-serif;
        font-weight: 900;
        font-style: normal;
        font-size: 53pt;
        color: black;
        margin: 0;
        padding-top: 0pt;
        line-height: 100%;
    }

    .subtitle {
        text-transform: uppercase;
        font-family: brandon-grotesque, sans-serif;
        font-weight: 900;
        font-style: normal;
        font-size: 53pt;
        color: #F26E3B;
        margin: 0;
        padding-top: 0pt;
        line-height: 100%;
    }

    .titlemeta {
        text-transform: uppercase;
        font-family: brandon-grotesque, sans-serif;
        font-weight: 300;
        font-style: normal;
        font-size: 24pt;
        color: black;
        margin: 0;
        padding-top: 0pt;
        line-height: 100%;
    }

    h1 {
        text-transform: uppercase;
        font-family: brandon-grotesque, sans-serif;
        font-weight: 900;
        font-style: normal;
        font-size: 24pt;
        color: #F26E3B;
        margin: 0;
        padding-top: 0pt;
        line-height: 120%;
    }

    h2 {
        text-transform: uppercase;
        font-family: brandon-grotesque, sans-serif;
        font-weight: 300;
        font-style: normal;
        font-size: 24pt;
        color: #F26E3B;
        margin: 0;
        padding-top: 0pt;
        line-height: 120%;
    }

    p {
        font-family: brandon-grotesque, sans-serif;
        font-size: 10pt;
        font-weight: 300;
        font-style: normal;
    }

    table {
        font-size: 9pt;

    }

    th {
        table-layout: auto;
        padding-top: 4pt;
        padding-left: 2pt;
        padding-right: 0pt;
        text-align: center;
        font-weight: bold;
        border-bottom-color: black;
        border-bottom-width: 1px;
        border-bottom-style: solid;
        border-top-color: black;
        border-top-width: 1px;
        border-top-style: black;
        word-wrap: break-word;
    }

    td {
        padding-top: 4pt;
        padding-left: 2pt;
        padding-right: 0pt;
        text-align: center;
    }

    img {
        vertical-align: top;
    }

    ul {
        list-style-position: outside;
        font-size: 11pt;
        padding-left: 5pt;
        padding-top: 0;
    }

    figcaption {
        font-size: 9pt;
    }

    caption {
        font-size: 9pt;
    }

    .footer {
        font-size: 10pt;
    }

    .vt_header {
        writing-mode: sideways-rl;
        }

    .tiny_header {
        font-size: 7px;
        }

</style>

<!-- Loading JSON data files for access -->
<!-- TODO - these will currently break because they need to be created/added to the precipy index -->

<!-- Title Page -->
<p><pdf:nexttemplate name="titlepage">
<pdf:nextpage></p>
<p class="subtitle">OPEN METADATA SOURCES</p>
<p class="titlemeta">
COMPARING OPENALEX TO CROSSREF AND MAG<br>
DATE: 11 MARCH 2022
</p>

<!-- switch page templates -->
<p><pdf:nexttemplate name="report"></p>
<p><pdf:nextpage></p>
<h1>Executive Summary</h1>
<p>Here we write some background stuff, probably using the abstracts we have I guess, can also include some
summary statistics and other useful things.</p>
<p>This report was run using the following tables as source data:
Crossref: academic-observatory.crossref.crossref_metadata20220107
Crossref Member Data: utrecht-university.crossref.member_data with date recent
OpenAlex Native Format utrecht-university.OpenAlex.Work20220130
Microsoft Academic:</p>
<ul>
<li>Papers: academic-observatory.mag.Papers20211206</li>
<li>Authors: academic-observatory.mag.Authors20211206</li>
<li>Affiliations: academic-observatory.mag.Affiliations20211206</li>
<li>Intermediate: utrecht-university.mag.mag_intermediate20211206</li>
</ul>
<p><pdf:nextpage></p>
<h1>Contents</h1>
<p>There is actually a way, I think of pulling in a table of contents, but I haven't done that previously. Or it can
be done manually obviously.</p>
<h1>Introduction and Background</h1>
<p>Stuff on MAG going away and the motivation for tracking completeness</p>
<h2>Data sources</h2>
<p>Do we need a section that gives some brief background on the data sources?</p>
<h3>Crossref Metadata</h3>
<h3>Microsoft Academic</h3>
<h3>OpenAlex</h3>
<h2>Goals of this report</h2>
<h2>Limitations</h2>
<h1>Coverage of OpenAlex vs Crossref</h1>
<h2>Comparing coverage</h2>
<p>OpenAlex is based initially on metadata from Microsoft Academic and the overall coverage compared to Crossref is
consistent with for publications over all time. Noting that OpenAlex has made a decision to not cover all the 
content types that MAG did, these two charts show a difference for the non-Crossref materials but very similar
results for the content that has Crossref DOIs.</p>
<p><img alt="" src="openalex_native_crossref_coverage_all_time.png" /></p>
<p><img alt="" src="mag_crossref_coverage_all_time.png" /></p>
<p>Therefore it is of interest to look at a specific recent year, in this case 2020.</p>
<p><img alt="" src="openalex_native_crossref_coverage_focus_year.png" /></p>
<h2>Value Add of OpenAlex to Crossref</h2>
<h3>Overview</h3>
<h3>Details</h3>
<p>We can do loops eg over the data elements. But this might be better for a supplementary data section as we will 
presumably want to actually comment on the graphs themselves? </p>
<p>TODO:
There is a bug in the xhtml2pdf package which means it
only works with complete paths on windows. This creates an issue as we would need to use precipy to give us the full
path but I'm not sure whether we can use a variable inside that full path declaration. Some experimentation required.</p>
<h3>Affiliation strings</h3>
<p><img alt="" src="value_add_openalex_native_all_time_for_affiliation_strings_by_cr_type.png" /></p>
<p>The above will not work on windows...may need to figure a work around for that</p>
<h3>Authors</h3>
<p><img alt="" src="value_add_openalex_native_all_time_for_authors_by_cr_type.png" /></p>
<p>The above will not work on windows...may need to figure a work around for that</p>
<h3>Abstracts</h3>
<p><img alt="" src="value_add_openalex_native_all_time_for_abstracts_by_cr_type.png" /></p>
<p>The above will not work on windows...may need to figure a work around for that</p>
<h3>Citations to</h3>
<p><img alt="" src="value_add_openalex_native_all_time_for_citations_to_by_cr_type.png" /></p>
<p>The above will not work on windows...may need to figure a work around for that</p>
<h3>References from</h3>
<p><img alt="" src="value_add_openalex_native_all_time_for_references_from_by_cr_type.png" /></p>
<p>The above will not work on windows...may need to figure a work around for that</p>
<h3>Journals</h3>
<p><img alt="" src="value_add_openalex_native_all_time_for_journals_by_cr_type.png" /></p>
<p>The above will not work on windows...may need to figure a work around for that</p>
<h3>Fields</h3>
<p><img alt="" src="value_add_openalex_native_all_time_for_fields_by_cr_type.png" /></p>
<p>The above will not work on windows...may need to figure a work around for that</p>
<h1>OpenAlex Coverage Beyond Crossref</h1>
<h2>Publication Types</h2>
<h2>Metadata Coverage</h2>
<h3>Overall</h3>
<h3>By publication type</h3>
<h3>By field</h3>
<h1>Methodology</h1>
<h1>Appendices</h1>
<h2>Appendix A - Complete Tables</h2>
<h2>Appendix B - Historical MAG Analysis??</h2>
<ol>
<li>OpenAlex - non-Crossref coverage
4a. Publication types - with and without (Crossref?) DOIs
4b. Coverage of 6 main parameters - with /without (Crossref?) DOIs
4c. Coverage of 6 main parameters per publication type </li>
<li>with/without (Crossref?) DOIs</li>
<li>Methodology</li>
<li>Appendix - tables with AllTheThingsTM</li>
</ol>